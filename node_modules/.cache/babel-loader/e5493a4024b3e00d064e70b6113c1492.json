{"ast":null,"code":"import \"core-js/modules/es.regexp.constructor.js\";\nimport \"core-js/modules/es.regexp.dot-all.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.regexp.sticky.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/web.url.js\";\nimport \"core-js/modules/web.url-search-params.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/es.regexp.test.js\";\nimport \"core-js/modules/es.string.trim.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from 'axios';\nvar sessionUser = JSON.parse(sessionStorage.getItem('user'));\nexport default {\n  name: 'espace-user',\n  data: function data() {\n    return {\n      user: '',\n      modifUser: false,\n      userId: sessionUser.userId,\n      tokenUser: sessionUser.token,\n      url: null,\n      alt_text: null,\n      modifImg: false,\n      boolAffichMsg: false,\n      regexpBoolName: null,\n      regexpBoolFirstName: null,\n      regexpBoolAdress: null,\n      regexpBoolCity: null,\n      regexpBoolPassword: null,\n      firstNameRegExp: new RegExp(\"^[a-zA-Z\\xE0\\xE2\\xE4\\xE9\\xE8\\xEA\\xEB\\xEF\\xEE\\xF4\\xF6\\xF9\\xFB\\xFC\\xE7\\xB0 -]{1,}$\"),\n      passwordRegExp: new RegExp(\"^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])(?=.{8,})\"),\n      lastNameRegExp: new RegExp(\"^[a-zA-Z\\xE0\\xE2\\xE4\\xE9\\xE8\\xEA\\xEB\\xEF\\xEE\\xF4\\xF6\\xF9\\xFB\\xFC\\xE7\\xB0 -]{1,}$\"),\n      regexAddress: new RegExp(/^[a-zA-Z0-9 ]+$/),\n      cityRegExp: new RegExp(\"^[a-zA-Z\\xE0\\xE2\\xE4\\xE9\\xE8\\xEA\\xEB\\xEF\\xEE\\xF4\\xF6\\xF9\\xFB\\xFC\\xE7\\xB0 -]{1,}$\")\n    };\n  },\n  mounted: function mounted() {\n    var _this = this;\n\n    axios.get(\"http://localhost:3000/api/auth/\" + sessionUser.userId, {\n      headers: {\n        'Authorization': 'Bearer ' + sessionUser.token\n      }\n    }).then(function (response) {\n      return _this.user = response.data;\n    }).catch(function (error) {\n      error;\n      sessionStorage.clear();\n      location.reload();\n      window.location.assign(\"http://localhost:8080/\");\n    });\n    axios.get(\"http://localhost:3000/api/post/\" + sessionUser.userId, {}).then(function (response) {\n      var postdata = JSON.parse(response.data);\n      postdata.forEach(function (response) {\n        console.log(response);\n\n        if (!response.imageUrl) {\n          response.imageUrl = \"\";\n        }\n\n        var modifyText = '';\n\n        if (response.userId == sessionUser.userId) {\n          modifyText = 'Modifier';\n        }\n\n        if (response.imageUrl != \"\") {\n          var articleCreate = document.createElement('article');\n          articleCreate.className = 'cart__post';\n          articleCreate.id = 'article__' + response._id + '';\n          articleCreate.dataset.id = response._id;\n          articleCreate.innerHTML = \"\\n                <div class=\\\"cart__nav-div\\\">\\n                    <img class=\\\"imgUserGet\\\"  src=\\\"\".concat(response.imageUrlUser, \"\\\" alt=\\\"image de profil\\\">\\n                    <h2 class=\\\"namePostGet\\\">\").concat(response.NameUser, \" \").concat(response.FirstNameUser, \"</h2>\\n                    <button class=\\\"modifyPostGet\\\" >\").concat(modifyText, \"</button>\\n                </div>\\n                \\n                <img class=\\\"imgPostGet\\\" src=\\\"\").concat(response.imageUrl, \"\\\" alt=\\\"image du post\\\">\\n\\n                <div class=\\\"cart__foot-div\\\">\\n                  <div class=\\\"div-like\\\">\\n                    <a class=\\\"affichCommPost\\\">Afficher les commentaires</a>\\n                  </div>\\n                    <h4 class=\\\"titlePostGet\\\">\").concat(response.Title, \"</h4>\\n                    <p class=\\\"contentPostGet\\\">\").concat(response.Content, \"</p>\\n                </div>\\n\\n                 <div class=\\\"cart__com-div\\\">\\n                   <input type=\\\"text\\\" class=\\\"textareaPostGet\\\" placeholder=\\\"Ajouter un commentaire...\\\"></input>\\n                   <a class=\\\"commPostGet\\\" href=\\\"#\\\">Publier</a>\\n                 </div>\");\n          document.getElementById('post').appendChild(articleCreate);\n        } else {\n          var _articleCreate = document.createElement('article');\n\n          _articleCreate.className = 'cart__post';\n          _articleCreate.id = 'article__' + response._id + '';\n          _articleCreate.dataset.id = response._id;\n          _articleCreate.innerHTML = \"\\n                <div class=\\\"cart__nav-div\\\">\\n                    <img class=\\\"imgUserGet\\\"  src=\\\"\".concat(response.imageUrlUser, \"\\\" alt=\\\"image de profil\\\">\\n                    <h2 class=\\\"namePostGet\\\">\").concat(response.NameUser, \" \").concat(response.FirstNameUser, \"</h2>\\n                    <button class=\\\"modifyPostGet\\\">\").concat(modifyText, \"</button>\\n                </div>\\n                <div class=\\\"cart__foot-div\\\">\\n                  <div class=\\\"div-like\\\">\\n                    <a class=\\\"affichCommPost\\\">Afficher les commentaires</a>\\n                  </div>\\n                    <h4 class=\\\"titlePostGet\\\">\").concat(response.Title, \"</h4>\\n                    <p class=\\\"contentPostGet\\\">\").concat(response.Content, \"</p>\\n                </div>\\n\\n                 <div class=\\\"cart__com-div\\\">\\n                   <input type=\\\"text\\\" class=\\\"textareaPostGet\\\" placeholder=\\\"Ajouter un commentaire...\\\"></input>\\n                   <a class=\\\"commPostGet\\\" href=\\\"#\\\">Publier</a>\\n                 </div>\");\n          document.getElementById('post').appendChild(_articleCreate);\n        }\n      });\n    }).catch(function (error) {\n      error;\n    });\n  },\n  methods: {\n    modifPost: function modifPost(e) {\n      axios.get(\"http://localhost:3000/api/post/\", {}).then(function (response) {\n        var postdata = JSON.parse(response.data);\n\n        if (e.target.className === 'modifyPostGet') {\n          var dataSetId = e.target.closest('.cart__post').dataset.id;\n          postdata.forEach(function (post) {\n            if (post._id == dataSetId) {\n              if (post.imageUrl != \"\") {\n                axios.get(\"http://localhost:3000/api/auth/\" + post.userId, {\n                  headers: {\n                    'Authorization': 'Bearer ' + sessionUser.token\n                  }\n                }).then(function (postdataNew) {\n                  var userDataNew = postdataNew.data;\n\n                  if (post.imageUrl != null) {\n                    document.querySelector('#article__' + post._id + '').innerHTML = \" <div class=\\\"cart__nav-div\\\">\\n                    <img class=\\\"imgUserGet\\\"  src=\\\"\".concat(userDataNew.imageUrl, \"\\\" alt=\\\"image de profil\\\">\\n                    <h2 class=\\\"namePostGet\\\">\").concat(userDataNew.Name, \" \").concat(userDataNew.FirstName, \"</h2>\\n                </div>\\n                \\n                <img id=\\\"img__\").concat(post._id, \"\\\" class=\\\"imgPostGet\\\" src=\\\"\").concat(post.imageUrl, \"\\\" alt=\\\"image du post\\\">\\n\\n                <div class=\\\"cart__foot-div-modif\\\">\\n                    <input type=\\\"file\\\" id=\\\"button__\").concat(post._id, \"\\\" class=\\\"modifButtonPostTest\\\">Cliquer ici pour modifier l'image</input>\\n                    <button class=\\\"modifButtonPost\\\">Cliquer ici pour modifier l'image</button>\\n                    <h3  class=\\\"titlePostGetModif\\\">Titre du post</h3>\\n                    <input id=\\\"title__\").concat(post._id, \"\\\" type='text' class=\\\"inputTextModif\\\" value=\\\"\").concat(post.Title, \"\\\"></input>\\n                    <h4 class=\\\"titlePostGet\\\">Contenu du post</h4>\\n                    <textarea id=\\\"textarea__\").concat(post._id, \"\\\" class=\\\"inputTextAreaModif\\\">\").concat(post.Content, \"</textarea>\\n                </div>\\n\\n                 <div class=\\\"cart__com-div-modif\\\">\\n\\n                   <a id=\\\"post__\").concat(post._id, \"\\\" class=\\\"commPostGet\\\" href=\\\"#\\\">Confirmer</a>\\n                 </div>\");\n                  } else {\n                    document.querySelector('#article__' + post._id + '').innerHTML = \" <div class=\\\"cart__nav-div\\\">\\n                    <img class=\\\"imgUserGet\\\"  src=\\\"\".concat(userDataNew.imageUrl, \"\\\" alt=\\\"image de profil\\\">\\n                    <h2 class=\\\"namePostGet\\\">\").concat(userDataNew.Name, \" \").concat(userDataNew.FirstName, \"</h2>\\n                </div>\\n\\n                <div class=\\\"cart__foot-div-modif\\\">\\n                <input type=\\\"file\\\" id=\\\"button__\").concat(post._id, \"\\\" class=\\\"modifButtonPostTest\\\">Cliquer ici pour modifier l'image</input>\\n                    <button class=\\\"modifButtonPost\\\">Cliquer ici pour ajouter une image</button>\\n                    <h3 class=\\\"titlePostGet\\\">Titre du post</h3>\\n                    <input id=\\\"title__\").concat(post._id, \"\\\"  type='text' class=\\\"inputTextModif\\\" value=\\\"\").concat(post.Title, \"\\\"></input>\\n                    <h4 class=\\\"titlePostGet\\\">Contenu du post</h4>\\n                    <textarea id=\\\"textarea__\").concat(post._id, \"\\\" class=\\\"inputTextAreaModif\\\">\").concat(post.Content, \"</textarea>\\n                </div>\\n\\n                 <div class=\\\"cart__com-div-modif\\\">\\n\\n                   <a id=\\\"post__\").concat(post._id, \"\\\" class=\\\"commPostGet\\\" href=\\\"#\\\">Confirmer</a>\\n                 </div>\");\n                  }\n\n                  if (post._id == dataSetId) {\n                    var imgInput = document.querySelector(\"#button__\" + post._id + \"\");\n                    imgInput.addEventListener(\"change\", function (e) {\n                      if (document.getElementById(\"img__\" + post._id + \"\")) {\n                        var file = e.target.files[0];\n                        this.url = URL.createObjectURL(file);\n                        document.getElementById(\"img__\" + post._id + \"\").src = \"\" + this.url + \"\";\n                      } else {\n                        var _file = e.target.files[0];\n                        this.url = URL.createObjectURL(_file);\n                        var img = document.createElement('img');\n                        img.className = \"imgPostGet\";\n                        img.src = \"\" + this.url + \"\";\n                        var parent = document.querySelector('#article__' + post._id + '');\n                        var nodeBefore = document.querySelector('.cart__foot-div-modif');\n                        parent.insertBefore(img, nodeBefore);\n                      }\n                    });\n                    var sendModif = document.querySelector(\"#post__\" + post._id + \"\");\n                    sendModif.addEventListener(\"click\", function () {\n                      var updatePost = {\n                        Title: document.querySelector(\"#title__\" + post._id + \"\").value,\n                        Content: document.querySelector(\"#textarea__\" + post._id + \"\").value\n                      };\n\n                      if (document.getElementById(\"button__\" + post._id + \"\").files[0]) {\n                        var image = document.getElementById(\"button__\" + post._id + \"\").files[0]; // Création d'un formData obligatoire pour envoi de l'image\n\n                        var formData = new FormData();\n                        formData.append('image', image); // Envoi des données sur l'url du serveur (mettez la votre) en POST en envoyant le formData contenant notre image et notre texte\n\n                        axios.put('http://localhost:3000/api/post/postImg/' + post._id, formData, {\n                          headers: {\n                            'Authorization': 'Bearer ' + sessionUser.token\n                          }\n                        }).then(function (resp) {\n                          resp;\n                        }).catch(function (err) {\n                          err.response;\n                        });\n                      }\n\n                      fetch('http://localhost:3000/api/post/postText/' + post._id, {\n                        method: \"PUT\",\n                        headers: {\n                          'Accept': 'application/json',\n                          'Content-type': 'application/json',\n                          'Authorization': 'Bearer ' + sessionUser.token\n                        },\n                        body: JSON.stringify(updatePost)\n                      }).then(function (modify) {\n                        return modify;\n                      }).catch(function (error) {\n                        error;\n                      });\n                      location.reload();\n                    });\n                  }\n                });\n              }\n            }\n          });\n        }\n      });\n    },\n    UserValid: function UserValid() {\n      var updateUser = {\n        Name: document.querySelector('#Nom-modifUser').value,\n        FirstName: document.querySelector('#FirstName-modifUser').value,\n        Password: document.querySelector('#Password-modifUser').value,\n        City: document.querySelector('#City-modifUser').value,\n        Adress: document.querySelector('#Adress-modifUser').value\n      };\n      fetch('http://localhost:3000/api/auth/' + this.userId, {\n        method: \"PUT\",\n        headers: {\n          'Accept': 'application/json',\n          'Content-type': 'application/json',\n          'Authorization': 'Bearer ' + sessionUser.token\n        },\n        body: JSON.stringify(updateUser)\n      }).then(function (modify) {\n        return modify;\n      }).catch(function (error) {\n        error;\n      });\n    },\n    onEnter: function onEnter() {\n      var nameSignup = document.getElementById('Nom-modifUser');\n      var firstNameSignup = document.getElementById('FirstName-modifUser');\n      var adressSignup = document.getElementById('Adress-modifUser');\n      var citySignup = document.getElementById('City-modifUser');\n      var passwordSignup = document.getElementById('Password-modifUser');\n      if (this.lastNameRegExp.test(nameSignup.value.trim()) ? this.regexpBoolName = true : this.regexpBoolName = false) ;\n      if (this.firstNameRegExp.test(firstNameSignup.value.trim()) ? this.regexpBoolFirstName = true : this.regexpBoolFirstName = false) ;\n      if (this.regexAddress.test(adressSignup.value.trim()) ? this.regexpBoolAdress = true : this.regexpBoolAdress = false) ;\n      if (this.cityRegExp.test(citySignup.value.trim()) ? this.regexpBoolCity = true : this.regexpBoolCity = false) ;\n      if (this.passwordRegExp.test(passwordSignup.value.trim()) ? this.regexpBoolPassword = true : this.regexpBoolPassword = false) ;\n      this.regexpBoolName = this.lastNameRegExp.test(nameSignup.value.trim()) ? true : false;\n    },\n    affichMsgConf: function affichMsgConf() {\n      if (this.numberAffichMsg === false) {\n        this.numberAffichMsg = true;\n        document.getElementById('Password-modifUser').setAttribute(\"type\", \"password\");\n      } else {\n        this.numberAffichMsg = false;\n        document.getElementById('Password-modifUser').setAttribute(\"type\", \"text\");\n      }\n    },\n    onFileChange: function onFileChange(e) {\n      this.modifImg = true;\n      var file = e.target.files[0];\n      this.url = URL.createObjectURL(file); // Récupération de l'image\n\n      var image = document.getElementById('Img-modifUser').files[0]; // Création d'un formData obligatoire pour envoi de l'image\n\n      var formData = new FormData();\n      formData.append('image', image);\n      formData.append('alt_text', this.alt_text); // Envoi des données sur l'url du serveur (mettez la votre) en POST en envoyant le formData contenant notre image et notre texte\n\n      axios.put('http://localhost:3000/api/auth/img/' + this.userId, formData, {\n        headers: {\n          'Authorization': 'Bearer ' + sessionUser.token\n        }\n      }).then(function (resp) {\n        resp;\n      }).catch(function (err) {\n        err.response;\n      });\n    },\n    updateUser: function updateUser() {\n      this.modifUser = true;\n    },\n    suppUser: function suppUser() {\n      var suppConfirm = confirm(\"Voulez-vous supprimez votre compte ?\");\n\n      if (suppConfirm === true) {\n        axios.delete(\"http://localhost:3000/api/auth/\" + this.userId, {\n          headers: {\n            'Authorization': 'Bearer ' + sessionUser.token\n          }\n        }).then(function (response) {\n          return response;\n        });\n        sessionStorage.clear();\n        location.reload();\n        window.location.assign(\"http://localhost:8080/\");\n      }\n    }\n  }\n};","map":{"version":3,"mappings":"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","names":["name","data","user","modifUser","userId","tokenUser","url","alt_text","modifImg","boolAffichMsg","regexpBoolName","regexpBoolFirstName","regexpBoolAdress","regexpBoolCity","regexpBoolPassword","firstNameRegExp","passwordRegExp","lastNameRegExp","regexAddress","cityRegExp","mounted","axios","headers","then","catch","error","sessionStorage","location","window","postdata","console","response","modifyText","articleCreate","document","methods","modifPost","e","userDataNew","post","imgInput","img","parent","sendModif","Title","Content","formData","resp","err","fetch","method","body","UserValid","Name","FirstName","Password","City","Adress","onEnter","affichMsgConf","onFileChange","updateUser","suppUser","delete"],"sourceRoot":"src/components/forum","sources":["espaceUser.vue"],"sourcesContent":["<template>\n    <div id=\"table-column\">\n        <div  v-show=\"modifUser === false\" class=\"mb-3 page2\">  \n          <img class=\"imgUser\" v-if=\"user.imageUrl\"  :src=\"user.imageUrl\" alt=\"image de profil\">\n          <img class=\"imgUser\" v-if=\"!user.imageUrl\" src=\"../../assets/test4.jpeg\" alt=\"image de profil\">\n          <h1 class=\"nameUser\" >{{user.FirstName}} {{user.Name}}</h1>\n          <p class=\"paramsUser\">Adresse mail : {{user.Email}}</p>\n          <p class=\"paramsUser\">Date de naissance : {{user.Birthday}}</p>\n          <p class=\"paramsUser\">Ville : {{user.City}}</p>\n          <p class=\"paramsUser\">Adresse: {{user.Adress}}</p>\n          <div v-show=\"modifUser === false\" class=\"buttonUser\">\n              <button @click=\"updateUser\" class=\"modifButtonUser\">Modifier</button>\n              <button @click=\"suppUser\" class=\"suppButtonUser\">Supprimer mon compte</button>\n          </div>\n          </div>\n        \n         <div id=\"post\" v-on:click=\"function(e){modifPost(e)}\" v-show=\"modifUser === false\" class=\"mb-5 page2\">  \n                <h2 class=\"titlePost\">Fil d'actualité personnel</h2>\n         </div>\n \n\n          \n           <div v-show=\"modifUser === true\" class=\"mb-3 page2\"> \n\n        <img class=\"imgUser\" v-if=\"user.imageUrl && url === null\"  :src=\"user.imageUrl\" alt=\"image de profil\">\n        <img class=\"imgUser\" v-if=\"url\" :src=\"url\" />\n        <img class=\"imgUser\" v-if=\"user.imageUrl === null && url === null\" src=\"../../assets/test4.jpeg\" alt=\"image de profil\">\n\n\n         <label id=\"fontTextImg\" class=\"form-label\" for=\"Img-modifUser\">Sélectionner une image de profil </label>\n\n         <div class=\"icoDiv\">\n           <input type=\"file\" class=\"template-login-signup\" encType=\"mutipart/form-data\" accept=\".jpg, .png, .gif\" id=\"Img-modifUser\" @change=\"onFileChange\" />\n           <p class=\"buttonUpdateImg\">Modifier l'image</p>\n        </div>      \n                    \n        <label for=\"Name-modifUser\" id=\"fontText\" class=\"form-label\">Nom</label>\n\n        <div class=\"icoDiv\">\n         <input type=\"text\" v-on:keyup=\"onEnter\" class=\"template-login-signup\" id=\"Nom-modifUser\"  placeholder=\"Ramtohul\">\n\n            <font-awesome-icon icon=\"fa-solid fa-triangle-exclamation\" class=\"test7\" v-show=\"regexpBoolName === false\" />\n            <font-awesome-icon icon=\"fa-solid fa-check\" class=\"test8\" v-show=\"regexpBoolName === true\" />\n\n        </div>\n\n        <label for=\"FirstName-modifUser\" id=\"fontText\" class=\"form-label\">Prénom</label>\n\n        <div class=\"icoDiv\">\n         <input type=\"text\" v-on:keyup=\"onEnter\" class=\"template-login-signup\" id=\"FirstName-modifUser\" v-bind:value= {{user.FirstName}} placeholder=\"Franck\">  \n\n           <font-awesome-icon icon=\"fa-solid fa-triangle-exclamation\" class=\"test7\" v-show=\"regexpBoolFirstName === false\" />\n           <font-awesome-icon icon=\"fa-solid fa-check\" class=\"test8\" v-show=\"regexpBoolFirstName === true\" />\n\n        </div>\n\n         <label for=\"City-modifUser\" id=\"fontText\"  class=\"form-label\">Ville</label>\n\n        <div class=\"icoDiv\">\n         <input type=\"text\" v-on:keyup=\"onEnter\" class=\"template-login-signup\" id=\"City-modifUser\"  placeholder=\"Dijon\">  \n\n           <font-awesome-icon icon=\"fa-solid fa-triangle-exclamation\" class=\"test7\" v-show=\"regexpBoolCity === false\" />\n           <font-awesome-icon icon=\"fa-solid fa-check\" class=\"test8\" v-show=\"regexpBoolCity === true\" />\n\n        </div>\n\n        <label for=\"Adress-modifUser\" id=\"fontText\" class=\"form-label\">Adresse</label>\n\n        <div class=\"icoDiv\">\n         <input type=\"text\" v-on:keyup=\"onEnter\" class=\"template-login-signup\" id=\"Adress-modifUser\"  placeholder=\"32 rue de Dijon\"> \n\n          <font-awesome-icon icon=\"fa-solid fa-triangle-exclamation\" class=\"test7\" v-show=\"regexpBoolAdress === false\" />\n          <font-awesome-icon icon=\"fa-solid fa-check\" class=\"test8\" v-show=\"regexpBoolAdress === true\" />\n\n        </div>\n\n        <label for=\"Password-modifUser\" id=\"fontText\" class=\"form-label\">Mot de passe</label>\n\n        <div class=\"icoDiv\">\n         <input type=\"password\" v-on:keyup=\"onEnter\" class=\"template-login-signup\" id=\"Password-modifUser\"  placeholder=\"Group&1mania\">  \n         <font-awesome-icon @click=\"affichMsgConf\" icon=\"fa-solid fa-eye-low-vision\" class=\"test8 test9\" />\n         <font-awesome-icon icon=\"fa-solid fa-triangle-exclamation\" class=\"test11\" v-show=\"regexpBoolPassword === false\" />\n         <font-awesome-icon icon=\"fa-solid fa-check\" class=\"test10\" v-show=\"regexpBoolPassword === true\" />\n        </div>\n\n          <div v-show=\"modifUser === true\" class=\"buttonUserUpdate\">\n              <button @click=\"UserValid\" class=\"updateButtonUser\">Confirmer</button>\n          </div>\n          </div>\n          \n\n    </div>\n</template>\n\n<script>\n\n\nimport axios from 'axios';\nlet sessionUser = JSON.parse(sessionStorage.getItem('user'));\n\nexport default {   \n   name: 'espace-user',\n   \n   data(){\n       return{\n           user : '',\n           modifUser: false,\n           userId: sessionUser.userId,\n           tokenUser: sessionUser.token,\n           url: null,\n           alt_text: null,\n           modifImg: false,\n           boolAffichMsg: false,\n           regexpBoolName: null, \n           regexpBoolFirstName: null,\n           regexpBoolAdress: null,\n           regexpBoolCity: null,\n           regexpBoolPassword: null,\n        \n        firstNameRegExp : new RegExp(`^[a-zA-Zàâäéèêëïîôöùûüç° -]{1,}$`),\n        passwordRegExp : new RegExp(`^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])(?=.{8,})`),\n        lastNameRegExp : new RegExp(`^[a-zA-Zàâäéèêëïîôöùûüç° -]{1,}$`),\n        regexAddress : new RegExp(/^[a-zA-Z0-9 ]+$/),\n        cityRegExp : new RegExp(`^[a-zA-Zàâäéèêëïîôöùûüç° -]{1,}$`),\n       }\n   },\n   mounted () {\n        \n         axios.get(`http://localhost:3000/api/auth/` + sessionUser.userId, {\n        headers: {\n           'Authorization':'Bearer ' + sessionUser.token,\n               },\n        })\n       .then(response => (this.user = response.data))\n       .catch((error) => {\n           error\n           sessionStorage.clear();\n           location.reload();\n           window.location.assign(`http://localhost:8080/`)\n       })\n\n        axios.get(`http://localhost:3000/api/post/` + sessionUser.userId, {\n        \n        })\n       .then(response => {\n            let postdata = JSON.parse(response.data);\n            \n            postdata.forEach((response) => {\n                \n                  console.log(response)\n                   if(!response.imageUrl){\n                       response.imageUrl = \"\"\n                   }\n                  let modifyText = '';\n                  if(response.userId == sessionUser.userId){\n                      modifyText = 'Modifier';\n                  }\n            if(response.imageUrl != \"\"){\n                let articleCreate = document.createElement('article');\n                articleCreate.className = 'cart__post';\n                articleCreate.id = 'article__' + response._id + '';\n                articleCreate.dataset.id = response._id;\n                articleCreate.innerHTML = `\n                <div class=\"cart__nav-div\">\n                    <img class=\"imgUserGet\"  src=\"${response.imageUrlUser}\" alt=\"image de profil\">\n                    <h2 class=\"namePostGet\">${response.NameUser} ${response.FirstNameUser}</h2>\n                    <button class=\"modifyPostGet\" >${modifyText}</button>\n                </div>\n                \n                <img class=\"imgPostGet\" src=\"${response.imageUrl}\" alt=\"image du post\">\n\n                <div class=\"cart__foot-div\">\n                  <div class=\"div-like\">\n                    <a class=\"affichCommPost\">Afficher les commentaires</a>\n                  </div>\n                    <h4 class=\"titlePostGet\">${response.Title}</h4>\n                    <p class=\"contentPostGet\">${response.Content}</p>\n                </div>\n\n                 <div class=\"cart__com-div\">\n                   <input type=\"text\" class=\"textareaPostGet\" placeholder=\"Ajouter un commentaire...\"></input>\n                   <a class=\"commPostGet\" href=\"#\">Publier</a>\n                 </div>`\n                   document.getElementById('post').appendChild(articleCreate);\n                  } \n            else{\n                let articleCreate = document.createElement('article');\n                articleCreate.className = 'cart__post';\n                articleCreate.id = 'article__' + response._id + '';\n                articleCreate.dataset.id = response._id;\n                articleCreate.innerHTML = `\n                <div class=\"cart__nav-div\">\n                    <img class=\"imgUserGet\"  src=\"${response.imageUrlUser}\" alt=\"image de profil\">\n                    <h2 class=\"namePostGet\">${response.NameUser} ${response.FirstNameUser}</h2>\n                    <button class=\"modifyPostGet\">${modifyText}</button>\n                </div>\n                <div class=\"cart__foot-div\">\n                  <div class=\"div-like\">\n                    <a class=\"affichCommPost\">Afficher les commentaires</a>\n                  </div>\n                    <h4 class=\"titlePostGet\">${response.Title}</h4>\n                    <p class=\"contentPostGet\">${response.Content}</p>\n                </div>\n\n                 <div class=\"cart__com-div\">\n                   <input type=\"text\" class=\"textareaPostGet\" placeholder=\"Ajouter un commentaire...\"></input>\n                   <a class=\"commPostGet\" href=\"#\">Publier</a>\n                 </div>`\n                   document.getElementById('post').appendChild(articleCreate);\n                  }\n\n              })\n              \n       })\n       .catch((error) => {\n           error\n       })\n  },\n   methods:{\n\n         modifPost(e) {\n            axios.get(`http://localhost:3000/api/post/`, {})\n                .then(response => {\n                    let postdata = JSON.parse(response.data);\n                    if (e.target.className === 'modifyPostGet') {\n                        let dataSetId = e.target.closest('.cart__post').dataset.id;\n                        postdata.forEach((post) => {\n                            if (post._id == dataSetId) {\n                                if (post.imageUrl != \"\") {\n                                    axios.get(`http://localhost:3000/api/auth/` + post.userId, {\n                                            headers: {\n                                                'Authorization': 'Bearer ' + sessionUser.token,\n                                            },\n                                        })\n                                        .then(postdataNew => {\n                                            let userDataNew = postdataNew.data;\n                                            if (post.imageUrl != null) {\n\n                                                document.querySelector('#article__' + post._id + '').innerHTML = ` <div class=\"cart__nav-div\">\n                    <img class=\"imgUserGet\"  src=\"${userDataNew.imageUrl}\" alt=\"image de profil\">\n                    <h2 class=\"namePostGet\">${userDataNew.Name} ${userDataNew.FirstName}</h2>\n                </div>\n                \n                <img id=\"img__${post._id}\" class=\"imgPostGet\" src=\"${post.imageUrl}\" alt=\"image du post\">\n\n                <div class=\"cart__foot-div-modif\">\n                    <input type=\"file\" id=\"button__${post._id}\" class=\"modifButtonPostTest\">Cliquer ici pour modifier l'image</input>\n                    <button class=\"modifButtonPost\">Cliquer ici pour modifier l'image</button>\n                    <h3  class=\"titlePostGetModif\">Titre du post</h3>\n                    <input id=\"title__${post._id}\" type='text' class=\"inputTextModif\" value=\"${post.Title}\"></input>\n                    <h4 class=\"titlePostGet\">Contenu du post</h4>\n                    <textarea id=\"textarea__${post._id}\" class=\"inputTextAreaModif\">${post.Content}</textarea>\n                </div>\n\n                 <div class=\"cart__com-div-modif\">\n\n                   <a id=\"post__${post._id}\" class=\"commPostGet\" href=\"#\">Confirmer</a>\n                 </div>`\n\n                                            } else {\n\n                                                document.querySelector('#article__' + post._id + '').innerHTML = ` <div class=\"cart__nav-div\">\n                    <img class=\"imgUserGet\"  src=\"${userDataNew.imageUrl}\" alt=\"image de profil\">\n                    <h2 class=\"namePostGet\">${userDataNew.Name} ${userDataNew.FirstName}</h2>\n                </div>\n\n                <div class=\"cart__foot-div-modif\">\n                <input type=\"file\" id=\"button__${post._id}\" class=\"modifButtonPostTest\">Cliquer ici pour modifier l'image</input>\n                    <button class=\"modifButtonPost\">Cliquer ici pour ajouter une image</button>\n                    <h3 class=\"titlePostGet\">Titre du post</h3>\n                    <input id=\"title__${post._id}\"  type='text' class=\"inputTextModif\" value=\"${post.Title}\"></input>\n                    <h4 class=\"titlePostGet\">Contenu du post</h4>\n                    <textarea id=\"textarea__${post._id}\" class=\"inputTextAreaModif\">${post.Content}</textarea>\n                </div>\n\n                 <div class=\"cart__com-div-modif\">\n\n                   <a id=\"post__${post._id}\" class=\"commPostGet\" href=\"#\">Confirmer</a>\n                 </div>`\n\n                                            }\n                                            if (post._id == dataSetId) {\n\n                                            var imgInput = document.querySelector(\"#button__\"+post._id+\"\");\n                                            imgInput.addEventListener(\"change\", function(e){\n                                                if(document.getElementById(\"img__\"+post._id+\"\")){\n                                                      const file = e.target.files[0];\n                                                 this.url = URL.createObjectURL(file);\n                                                 document.getElementById(\"img__\"+post._id+\"\").src=\"\"+ this.url +\"\";\n                                                } else{\n                                                   const file = e.target.files[0];\n                                                   this.url = URL.createObjectURL(file);\n                                                   let img =  document.createElement('img');\n                                                   img.className= \"imgPostGet\";\n                                                   img.src = \"\"+ this.url +\"\";\n                                                   let parent = document.querySelector('#article__' + post._id + '');\n                                                   let nodeBefore = document.querySelector('.cart__foot-div-modif');\n                                                   parent.insertBefore(img,nodeBefore);\n                                                   \n                                                }\n                                               \n                                            });\n\n                                            var sendModif = document.querySelector(\"#post__\"+post._id+\"\");\n                                            sendModif.addEventListener(\"click\", function(){\n                                                let updatePost= {\n                                                   Title: document.querySelector(\"#title__\"+post._id+\"\").value,\n                                                   Content:   document.querySelector(\"#textarea__\"+post._id+\"\").value,\n                                                }\n                                                if(document.getElementById(\"button__\"+post._id+\"\").files[0]){\n                                                     let image = document.getElementById(\"button__\"+post._id+\"\").files[0]\n                                                // Création d'un formData obligatoire pour envoi de l'image\n                                                 let  formData = new FormData()\n                                                  formData.append('image', image)\n                                                  // Envoi des données sur l'url du serveur (mettez la votre) en POST en envoyant le formData contenant notre image et notre texte\n                                                  axios.put('http://localhost:3000/api/post/postImg/' + post._id, formData,{\n                                                  headers : {'Authorization':'Bearer ' + sessionUser.token }   \n                                                                             })\n                                                     .then((resp) => {\n                                                             resp\n                                                                  })\n                                                     .catch((err) => {\n                                                         err.response\n                                                                     })                \n                                                }\n                                                \n                                                    fetch('http://localhost:3000/api/post/postText/' + post._id,{\n                                                     method: \"PUT\", \n                                                    headers:{  'Accept': 'application/json',\n                                                   'Content-type': 'application/json',\n                                                   'Authorization':'Bearer ' + sessionUser.token,\n                                                            },\n                                                          body: JSON.stringify(updatePost),\n                                                               })\n                                                           .then(modify => modify)\n                                                           .catch((error) => {\n                                                                    error\n                                                                             })\n\n                                                                location.reload();\n                                                         \n                                                                });\n                                            }\n                                        })\n\n                                }\n                            }\n\n                        })\n                    }\n                })\n        },\n        UserValid(){\n\n      let updateUser = {\n          Name :document.querySelector('#Nom-modifUser').value,\n          FirstName :document.querySelector('#FirstName-modifUser').value,\n          Password : document.querySelector('#Password-modifUser').value,\n          City : document.querySelector('#City-modifUser').value,\n          Adress : document.querySelector('#Adress-modifUser').value,\n      };\n     \n    \n      fetch('http://localhost:3000/api/auth/' + this.userId,{\n       method: \"PUT\", \n       headers:{  'Accept': 'application/json',\n       \n                  'Content-type': 'application/json',\n                  'Authorization':'Bearer ' + sessionUser.token,\n     },\n     body: JSON.stringify(updateUser),\n      })\n       .then(modify => modify)\n       .catch((error) => {\n           error\n       })\n\n    },\n           onEnter(){\n        let  nameSignup = document.getElementById('Nom-modifUser');\n        let  firstNameSignup = document.getElementById('FirstName-modifUser');\n        let  adressSignup = document.getElementById('Adress-modifUser');\n        let  citySignup = document.getElementById('City-modifUser');\n        let  passwordSignup = document.getElementById('Password-modifUser');\n\n        if(this.lastNameRegExp.test(nameSignup.value.trim()) ? this.regexpBoolName = true : this.regexpBoolName = false);\n        if(this.firstNameRegExp.test(firstNameSignup.value.trim()) ? this.regexpBoolFirstName = true : this.regexpBoolFirstName = false);\n        if(this.regexAddress.test(adressSignup.value.trim()) ? this.regexpBoolAdress = true : this.regexpBoolAdress = false);\n        if(this.cityRegExp.test(citySignup.value.trim()) ? this.regexpBoolCity = true : this.regexpBoolCity = false);\n        if(this.passwordRegExp.test(passwordSignup.value.trim()) ? this.regexpBoolPassword = true : this.regexpBoolPassword = false);\n         this.regexpBoolName = (this.lastNameRegExp.test(nameSignup.value.trim()) ? true : false);\n    },\n\n    affichMsgConf(){\n        if(this.numberAffichMsg === false){\n            this.numberAffichMsg = true;\n             document.getElementById('Password-modifUser').setAttribute(\"type\",\"password\");\n        } else {\n            this.numberAffichMsg = false;\n            document.getElementById('Password-modifUser').setAttribute(\"type\",\"text\");\n        }\n    },\n     onFileChange(e) {\n      this.modifImg = true;\n      const file = e.target.files[0];\n      this.url = URL.createObjectURL(file);\n      // Récupération de l'image\n      let image = document.getElementById('Img-modifUser').files[0]\n      // Création d'un formData obligatoire pour envoi de l'image\n        let  formData = new FormData()\n        formData.append('image', image)\n        formData.append('alt_text', this.alt_text)\n        // Envoi des données sur l'url du serveur (mettez la votre) en POST en envoyant le formData contenant notre image et notre texte\n          axios.put('http://localhost:3000/api/auth/img/' + this.userId, formData,{\n              headers : {'Authorization':'Bearer ' + sessionUser.token }   \n              })\n          .then((resp) => {\n            resp\n          })\n          .catch((err) => {\n            err.response\n          })\n     },\n\n       updateUser(){\n         this.modifUser = true;\n       },\n\n       suppUser(){\n         let suppConfirm = confirm(\"Voulez-vous supprimez votre compte ?\")\n         if(suppConfirm === true ){\n              axios\n          .delete(`http://localhost:3000/api/auth/` + this.userId,{\n              headers: {\n           'Authorization':'Bearer ' + sessionUser.token,\n               },\n          })\n          .then(response => response)\n          sessionStorage.clear();\n          location.reload();\n          window.location.assign(`http://localhost:8080/`)\n         }\n       }\n   }\n   \n}\n\n\n</script>\n\n\n<style>\n.titlePost{\n    font-size: 2rem;\n    margin-bottom: 5%;\n}\n\n#table-column{\n    flex-direction: column;\n}\n.mb-3{\n    padding-top: 0%;\n}\n.test8{\n    width: 25px;\n    height: 26px;\n    color: green;\n    position: absolute;\n    top: 38%;\n    right: 25%;\n}\n.test9{\ncursor: grab;\n}\n.test7{\n     width: 30px;\n    height: 26px;\n    color: red;\n    position: absolute;\n    top: 38%;\n    right: 25%;\n}\n.test11{\n       width: 30px;\n    height: 26px;\n    color: red;\n    position: absolute;\n    top: 38%;\n    right: 29%;\n}\n.test10{\n     width: 25px;\n    height: 26px;\n    color: green;\n    position: absolute;\n    top: 38%;\n    right: 29%;\n}\n.buttonUpdateImg{\n    color: white;\n    border-radius: 15px / 15px;\n    background: green;\n    position: absolute;\n    width: 49%;\n    height: 100%;\n    font-family: 'Raleway', sans-serif;\n    font-size: 1.5rem;\n    display: flex;\n    align-content: center;\n    align-items: center;\n    justify-content: center;\n    \n}\n\n#Img-modifUser{\n    z-index: 1;\n    opacity: 0;\n    padding-top: 15px;\n    margin-top: 5px;\n    cursor: grab;\n}\n#fontTextImg{\n    margin-top: 3%;\n    font-family: 'Raleway', sans-serif;\n    font-size: 1.2rem;\n    margin-bottom: 10px;\n    margin-top: 20px;\n    object-fit: cover;\n}\n.page2{\n    font-family: 'Raleway', sans-serif;\n}\n.imgUser{\n    height: 400px;\n    width: 100%;\n    border-radius: 0px;\n    border-top-left-radius: 15px;\n    border-top-right-radius: 15px;\n    image-rendering: auto;\n    object-fit: cover;\n}\n.imgUserUpdate{\n    height: 200px;\n    width: 100%;\n    border-radius: 0px;\n    border-top-left-radius: 15px;\n    border-top-right-radius: 15px;\n    image-rendering: auto;\n}\n.nameUser{\n    text-transform: uppercase;\n    font-size: 2rem;\n    margin-bottom: 4%;\n    margin-top: 5%;\n}\n\n.paramsUser{\n    font-size: 1.1rem;\n    margin-bottom: 3%;\n}\n.buttonUser{\n    display: flex;\n    flex-direction: column;\n    flex-wrap: wrap;\n}\n.modifButtonUser{\n    padding: 10%;\n    color: white;\n    background: green;\n    border: 0px;\n    cursor: grab;\n    border-radius: 15px / 15px;\n    font-size: 1rem;\n    margin-bottom: 5%;\n    font-family: 'Raleway', sans-serif;\n}\n.buttonUserUpdate{\n    width: 100%;\n    text-align: center;\n}\n.updateButtonUser{\n   color: white;\n    background: green;\n    border: 0px;\n    cursor: grab;\n    border-radius: 15px / 15px;\n    font-size: 1.2rem;\n    margin-bottom: 5%;\n    font-family: 'Raleway', sans-serif;\n    margin-top: 20px;\n    padding-left: 20%;\n    padding-right: 20%;\n    padding-top: 1.5%;\n    padding-bottom: 1.5%;\n}\n.suppButtonUser{\n    padding: 5%;\n    color: white;\n    background: red;\n    border: 0px;\n    cursor: grab;\n    border-radius: 15px / 15px;\n     font-size: 1rem;\n    font-family: 'Raleway', sans-serif;\n}\n</style>"]},"metadata":{},"sourceType":"module"}